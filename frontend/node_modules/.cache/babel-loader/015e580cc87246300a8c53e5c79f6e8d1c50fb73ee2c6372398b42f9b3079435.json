{"ast":null,"code":"import _objectSpread from\"F:/Projects/Automation Dashboard/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useCallback}from'react';import{useNavigate}from'react-router-dom';import{useAuth}from'../contexts/AuthContext';import apiClient from'../services/apiClient';import'./SocialMediaPage.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function FacebookPage(){const navigate=useNavigate();const{logout}=useAuth();const[isConnecting,setIsConnecting]=useState(false);const[connectionStatus,setConnectionStatus]=useState('');// Facebook OAuth states\nconst[selectedPage,setSelectedPage]=useState(null);const[availablePages,setAvailablePages]=useState([]);// Store all fetched pages\nconst[facebookConnected,setFacebookConnected]=useState(false);// Auto-reply toggle state\nconst[autoReplyEnabled,setAutoReplyEnabled]=useState(false);// Tab selection state\nconst[activeTab,setActiveTab]=useState('auto');// Auto post states\nconst[autoFormData,setAutoFormData]=useState({prompt:'',mediaType:'none',// 'none', 'photo', 'video'\nmediaFile:null,generatedContent:'',isGenerating:false});// Manual post states\nconst[manualFormData,setManualFormData]=useState({message:'',mediaType:'none',mediaFile:null});// Publishing state\nconst[isPublishing,setIsPublishing]=useState(false);// fetchPages function\nconst fetchPages=useCallback(async accessToken=>{console.debug('[fetchPages] Called with accessToken:',accessToken);console.debug('[fetchPages] Using dual apps:',USE_DUAL_APPS);if(!accessToken){setConnectionStatus('âŒ No Facebook access token found. Please try reconnecting.');setIsConnecting(false);setFacebookConnected(false);return{mappedPages:[],userInfo:null};}try{var _permissionsResponse$;// If using dual apps, get pages access token via direct API call\nif(USE_DUAL_APPS){console.debug('[fetchPages] Dual app mode - requesting pages access via direct API...');setConnectionStatus('ðŸ”„ Getting page permissions...');// For now, try using the original access token but with pages app API calls\n// This is a simplified approach that might work if the user has already granted permissions\nconsole.debug('[fetchPages] Using original access token for pages API calls');setConnectionStatus('ðŸ”„ Attempting to fetch pages with current permissions...');}// Check what permissions we actually have\nconst permissionsResponse=await new Promise((resolve,reject)=>{window.FB.api('/me/permissions',{access_token:accessToken},response=>{console.debug('[FB.api] /me/permissions response:',response);if(response.error)reject(new Error(response.error.message));else resolve(response);});});const grantedPermissions=((_permissionsResponse$=permissionsResponse.data)===null||_permissionsResponse$===void 0?void 0:_permissionsResponse$.filter(p=>p.status==='granted').map(p=>p.permission))||[];console.debug('[fetchPages] Granted permissions:',grantedPermissions);console.debug('[fetchPages] All permissions (including declined):',permissionsResponse.data);// In dual app mode, we expect basic permissions only\nif(USE_DUAL_APPS){console.debug('[fetchPages] Dual app mode - checking if we have basic login permissions');if(grantedPermissions.includes('public_profile')){console.debug('[fetchPages] Basic login successful, need to connect pages app');throw new Error('NEED_PAGES_AUTH');// Trigger pages auth flow\n}}else{// Check for required permissions in single app mode\nconst requiredPermissions=['pages_show_list','pages_manage_posts'];const missingPermissions=requiredPermissions.filter(p=>!grantedPermissions.includes(p));if(missingPermissions.length>0){setConnectionStatus(\"\\u274C Missing permissions: \".concat(missingPermissions.join(', '),\". Your app needs \\\"Pages API\\\" permissions.\"));console.error('[fetchPages] Missing required permissions:',missingPermissions);}}// Get user info\nconst userInfo=await new Promise((resolve,reject)=>{window.FB.api('/me',{access_token:accessToken,fields:'id,name,email'},response=>{console.debug('[FB.api] /me response:',response);if(response.error)reject(new Error(response.error.message));else resolve(response);});});// Get user's pages with extended permissions\nconst pagesResponse=await new Promise((resolve,reject)=>{window.FB.api('/me/accounts',{access_token:accessToken,fields:'id,name,category,access_token,picture,fan_count,tasks'},response=>{// Debug log for troubleshooting\nconsole.debug('[FB.api] /me/accounts response:',response);console.debug('[FB.api] /me/accounts full response object:',JSON.stringify(response,null,2));if(response.error){console.error('[FB.api] /me/accounts error details:',response.error);reject(new Error(\"\".concat(response.error.message,\" (Code: \").concat(response.error.code,\")\")));}else{resolve(response);}});});const pages=pagesResponse.data||[];const mappedPages=pages.map(page=>{var _page$picture,_page$picture$data;// Determine permissions from tasks array\nconst tasks=page.tasks||[];const canPost=tasks.includes('CREATE_CONTENT')||tasks.includes('MANAGE');const canComment=tasks.includes('MODERATE')||tasks.includes('MANAGE');return{id:page.id,name:page.name,category:page.category||'Page',access_token:page.access_token,profilePicture:((_page$picture=page.picture)===null||_page$picture===void 0?void 0:(_page$picture$data=_page$picture.data)===null||_page$picture$data===void 0?void 0:_page$picture$data.url)||'',canPost:canPost,canComment:canComment,followerCount:page.fan_count||0,tasks:tasks// Keep tasks for debugging\n};});setAvailablePages(mappedPages);// Page selection logic\nif(mappedPages.length===1){setSelectedPage(mappedPages[0]);setConnectionStatus(\"\\u2705 Connected successfully! 1 page found.\");}else if(mappedPages.length>1){setSelectedPage(null);// Prompt user to select a page\nsetConnectionStatus(\"\\u2705 Connected successfully! \".concat(mappedPages.length,\" pages found. Please select a page below.\"));}else{// Fallback to user profile if no pages available\nsetSelectedPage({id:userInfo.id,name:userInfo.name,access_token:accessToken,category:'Personal Profile',profilePicture:'',email:userInfo.email||'',isUserProfile:true,canPost:true,canComment:true,followerCount:0});setConnectionStatus('âœ… Connected as personal profile (no pages found).');}setFacebookConnected(true);setIsConnecting(false);return{mappedPages,userInfo};}catch(error){console.error('Facebook API error:',error);// If dual app mode and we get the specific pages auth trigger\nif(USE_DUAL_APPS&&(error.message==='NEED_PAGES_AUTH'||error.message.includes('permissions'))){console.debug('[fetchPages] Dual app mode - basic login successful, need pages auth');setConnectionStatus('âœ… Basic login successful! Now connect your pages app for page management.');setIsConnecting(false);setFacebookConnected(true);// Mark as connected to show the pages auth button\nreturn{mappedPages:[],userInfo:null,needsPagesAuth:true};}// If dual app mode but other error, still try pages auth\nif(USE_DUAL_APPS){console.debug('[fetchPages] Dual app mode - treating error as need for pages auth');setConnectionStatus('âœ… Basic login successful! Pages app connection needed for page management.');setIsConnecting(false);setFacebookConnected(true);// Mark as connected to show the pages auth button\nreturn{mappedPages:[],userInfo:null,needsPagesAuth:true};}setConnectionStatus('âŒ Failed to get Facebook data: '+(error.message||'Unknown error'));setIsConnecting(false);setFacebookConnected(false);return{mappedPages:[],userInfo:null};}},[USE_DUAL_APPS]);// connectToBackend function\nconst connectToBackend=async(accessToken,userInfo,mappedPages)=>{try{console.debug('[connectToBackend] Connecting to backend with:',{userInfo:userInfo===null||userInfo===void 0?void 0:userInfo.id,pagesCount:mappedPages.length,pagesData:mappedPages});const response=await apiClient.connectFacebook(accessToken,userInfo===null||userInfo===void 0?void 0:userInfo.id,mappedPages);console.debug('[connectToBackend] Backend response:',response);setConnectionStatus('âœ… Successfully connected to backend!');return response;}catch(error){console.error('Backend connection error:',error);setConnectionStatus('âŒ Backend connection failed: '+(error.message||'Unknown error'));throw error;}};// Icon Components\nconst ImageIcon=()=>/*#__PURE__*/_jsxs(\"svg\",{width:\"16\",height:\"16\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",children:[/*#__PURE__*/_jsx(\"rect\",{x:\"3\",y:\"3\",width:\"18\",height:\"18\",rx:\"2\",ry:\"2\"}),/*#__PURE__*/_jsx(\"circle\",{cx:\"8.5\",cy:\"8.5\",r:\"1.5\"}),/*#__PURE__*/_jsx(\"polyline\",{points:\"21,15 16,10 5,21\"})]});const AutoReplyIcon=()=>/*#__PURE__*/_jsx(\"svg\",{width:\"16\",height:\"16\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",children:/*#__PURE__*/_jsx(\"path\",{d:\"M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z\"})});const RocketIcon=()=>/*#__PURE__*/_jsxs(\"svg\",{width:\"16\",height:\"16\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",children:[/*#__PURE__*/_jsx(\"path\",{d:\"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M12 15l-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5\"})]});const AutoIcon=()=>/*#__PURE__*/_jsx(\"svg\",{width:\"16\",height:\"16\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",children:/*#__PURE__*/_jsx(\"path\",{d:\"M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5\"})});const ManualIcon=()=>/*#__PURE__*/_jsx(\"svg\",{width:\"16\",height:\"16\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",children:/*#__PURE__*/_jsx(\"path\",{d:\"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z\"})});const VideoIcon=()=>/*#__PURE__*/_jsxs(\"svg\",{width:\"16\",height:\"16\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",children:[/*#__PURE__*/_jsx(\"polygon\",{points:\"23 7 16 12 23 17 23 7\"}),/*#__PURE__*/_jsx(\"rect\",{x:\"1\",y:\"5\",width:\"15\",height:\"14\",rx:\"2\",ry:\"2\"})]});const SparkleIcon=()=>/*#__PURE__*/_jsx(\"svg\",{width:\"16\",height:\"16\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",children:/*#__PURE__*/_jsx(\"path\",{d:\"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.582a.5.5 0 0 1 0 .962L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0L9.937 15.5Z\"})});// Clean up any existing Facebook SDK instances\nconst cleanupFacebookSDK=()=>{const existingScript=document.getElementById('facebook-jssdk');if(existingScript){existingScript.remove();}if(window.FB){delete window.FB;}if(window.fbAsyncInit){delete window.fbAsyncInit;}};// Facebook App Configuration - SINGLE APP SETUP\nconst FACEBOOK_APPS={LOGIN:process.env.REACT_APP_FACEBOOK_APP_ID||'1526961221410200',// Using the page management app for everything\nPAGES:process.env.REACT_APP_FACEBOOK_APP_ID||'1526961221410200'// Same app ID\n};const USE_DUAL_APPS=false;// Force single app mode\n// Load Facebook SDK function\nconst loadFacebookSDK=function(){let appId=arguments.length>0&&arguments[0]!==undefined?arguments[0]:FACEBOOK_APPS.LOGIN;return new Promise((resolve,reject)=>{cleanupFacebookSDK();window.fbAsyncInit=function(){try{console.debug('[loadFacebookSDK] Initializing with App ID:',appId);window.FB.init({appId:appId,cookie:true,xfbml:true,version:'v19.0'});// Store current app ID for reference\nwindow.CURRENT_FB_APP_ID=appId;resolve();}catch(error){console.error('Facebook SDK initialization error:',error);reject(error);}};const script=document.createElement('script');script.id='facebook-jssdk';script.src='https://connect.facebook.net/en_US/sdk.js';script.async=true;script.defer=true;script.crossOrigin='anonymous';script.onerror=()=>{reject(new Error('Failed to load Facebook SDK script'));};document.body.appendChild(script);});};const handleAutoInputChange=e=>{const{name,value,files}=e.target;setAutoFormData(prev=>_objectSpread(_objectSpread({},prev),{},{[name]:files?files[0]:value}));};const handleManualInputChange=e=>{const{name,value,files}=e.target;setManualFormData(prev=>_objectSpread(_objectSpread({},prev),{},{[name]:files?files[0]:value}));};const handleMediaTypeChange=(type,formType)=>{if(formType==='auto'){setAutoFormData(prev=>_objectSpread(_objectSpread({},prev),{},{mediaType:type,mediaFile:null}));}else{setManualFormData(prev=>_objectSpread(_objectSpread({},prev),{},{mediaType:type,mediaFile:null}));}};// Generate content using Groq API\nconst generatePostContent=async()=>{if(!autoFormData.prompt.trim()){setConnectionStatus('âŒ Please enter a prompt for AI generation');return;}setAutoFormData(prev=>_objectSpread(_objectSpread({},prev),{},{isGenerating:true}));setConnectionStatus('ðŸ¤– Generating content with AI...');try{// Call your backend API to use Groq\nconst response=await apiClient.generateContent(autoFormData.prompt);setAutoFormData(prev=>_objectSpread(_objectSpread({},prev),{},{generatedContent:response.content,isGenerating:false}));setConnectionStatus('âœ… Content generated successfully!');}catch(error){console.error('Content generation error:',error);setConnectionStatus('âŒ Failed to generate content: '+(error.message||'Unknown error'));setAutoFormData(prev=>_objectSpread(_objectSpread({},prev),{},{isGenerating:false}));}};// UPDATED: Replace Make.com auto-reply webhook with backend API\nconst handleAutoReplyToggle=async()=>{const newState=!autoReplyEnabled;setAutoReplyEnabled(newState);try{setConnectionStatus('ðŸ”„ Updating auto-reply setting...');await apiClient.toggleAutoReply((selectedPage===null||selectedPage===void 0?void 0:selectedPage.id)||'user_profile',newState,'Thank you for your comment! We\\'ll get back to you soon.');setConnectionStatus(\"\".concat(newState?'âœ…':'âŒ',\" Auto-reply \").concat(newState?'enabled':'disabled'));}catch(error){console.error('Auto-reply toggle error:',error);setConnectionStatus('âŒ Failed to update auto-reply setting');setAutoReplyEnabled(!newState);// Revert on error\n}};// Publish post to Facebook\nconst publishPost=async()=>{if(!selectedPage){setConnectionStatus('âŒ Please select a page first');return;}// Determine content based on active tab\nconst isAutoMode=activeTab==='auto';const content=isAutoMode?autoFormData.generatedContent:manualFormData.message;const mediaType=isAutoMode?autoFormData.mediaType:manualFormData.mediaType;const mediaFile=isAutoMode?autoFormData.mediaFile:manualFormData.mediaFile;// Validation\nif(!content||content.trim()===''){setConnectionStatus('âŒ Please enter some content for your post');return;}if(mediaType!=='none'&&!mediaFile){setConnectionStatus('âŒ Please select a media file to upload');return;}try{setIsPublishing(true);setConnectionStatus('ðŸ”„ Publishing post to Facebook...');// If no media, just post text\nif(mediaType==='none'){await postTextOnly(content);}else{await postWithMedia(content,mediaFile,mediaType);}setConnectionStatus('âœ… Post published successfully!');// Clear form data after successful post\nif(isAutoMode){setAutoFormData(prev=>_objectSpread(_objectSpread({},prev),{},{prompt:'',generatedContent:'',mediaFile:null,mediaType:'none'}));}else{setManualFormData(prev=>_objectSpread(_objectSpread({},prev),{},{message:'',mediaFile:null,mediaType:'none'}));}}catch(error){console.error('Post publishing error:',error);setConnectionStatus('âŒ Failed to publish post: '+(error.message||'Unknown error'));}finally{setIsPublishing(false);}};// Post text-only content\nconst postTextOnly=async message=>{return new Promise((resolve,reject)=>{window.FB.api(\"/\".concat(selectedPage.id,\"/feed\"),'POST',{message:message,access_token:selectedPage.access_token},response=>{console.debug('[FB.api] Post response:',response);if(response.error){reject(new Error(\"\".concat(response.error.message,\" (Code: \").concat(response.error.code,\")\")));}else{resolve(response);}});});};// Post content with media (photo or video)\nconst postWithMedia=async(message,file,mediaType)=>{// Convert file to base64 for Facebook API\nconst fileData=await fileToBase64(file);if(mediaType==='photo'){return new Promise((resolve,reject)=>{window.FB.api(\"/\".concat(selectedPage.id,\"/photos\"),'POST',{caption:message,source:fileData,access_token:selectedPage.access_token},response=>{console.debug('[FB.api] Photo post response:',response);if(response.error){reject(new Error(\"\".concat(response.error.message,\" (Code: \").concat(response.error.code,\")\")));}else{resolve(response);}});});}else if(mediaType==='video'){return new Promise((resolve,reject)=>{window.FB.api(\"/\".concat(selectedPage.id,\"/videos\"),'POST',{description:message,source:fileData,access_token:selectedPage.access_token},response=>{console.debug('[FB.api] Video post response:',response);if(response.error){reject(new Error(\"\".concat(response.error.message,\" (Code: \").concat(response.error.code,\")\")));}else{resolve(response);}});});}};// Helper function to convert file to base64\nconst fileToBase64=file=>{return new Promise((resolve,reject)=>{const reader=new FileReader();reader.readAsDataURL(file);reader.onload=()=>resolve(reader.result);reader.onerror=error=>reject(error);});};// Check URL for pages auth callback\nReact.useEffect(()=>{const urlParams=new URLSearchParams(window.location.hash.substring(1));const accessToken=urlParams.get('access_token');const state=urlParams.get('state');if(accessToken&&state==='pages_auth'){console.debug('[useEffect] Found pages auth callback in URL');// Send message to opener window (popup parent)\nif(window.opener){window.opener.postMessage({type:'FACEBOOK_PAGES_AUTH',accessToken:accessToken},window.location.origin);window.close();}else{// Direct navigation case\n(async()=>{setConnectionStatus('ðŸ”„ Processing pages authentication...');const{mappedPages,userInfo}=await fetchPages(accessToken);if(mappedPages.length>0){await connectToBackend(accessToken,userInfo,mappedPages);}})();}// Clean up URL\nwindow.history.replaceState({},document.title,window.location.pathname);}},[fetchPages]);// Manual Pages App Login for Dual App Setup\nconst loginWithPagesApp=async()=>{setIsConnecting(true);setConnectionStatus('ðŸ” Connecting to Facebook Pages App...');try{// Direct redirect to pages app OAuth\nconst pagesAuthUrl=\"https://www.facebook.com/v19.0/dialog/oauth?\"+\"client_id=\".concat(FACEBOOK_APPS.PAGES,\"&\")+\"redirect_uri=\".concat(encodeURIComponent(window.location.origin),\"&\")+\"scope=pages_show_list,pages_manage_posts,pages_manage_engagement,pages_read_engagement&\"+\"response_type=token&\"+\"state=pages_auth&\"+\"display=popup\";// Open in popup\nconst popup=window.open(pagesAuthUrl,'facebookPagesAuth','width=600,height=400');// Listen for popup message\nconst handleMessage=event=>{if(event.origin!==window.location.origin)return;if(event.data.type==='FACEBOOK_PAGES_AUTH'){window.removeEventListener('message',handleMessage);popup.close();if(event.data.accessToken){console.debug('[loginWithPagesApp] Got pages access token:',event.data.accessToken);// Use the pages access token to fetch pages\n(async()=>{const{mappedPages,userInfo}=await fetchPages(event.data.accessToken);if(mappedPages.length>0){await connectToBackend(event.data.accessToken,userInfo,mappedPages);}})();}else{setConnectionStatus('âŒ Failed to get pages app permissions');setIsConnecting(false);}}};window.addEventListener('message',handleMessage);}catch(error){console.error('Pages app login error:',error);setConnectionStatus('âŒ Pages app login failed: '+error.message);setIsConnecting(false);}};const loginWithFacebook=async()=>{// Check HTTPS requirement first\nif(window.location.protocol!=='https:'&&window.location.hostname!=='localhost'){setConnectionStatus('âŒ Facebook login requires HTTPS. Please use https://localhost:3001 or deploy with HTTPS');return;}// Check if user is still authenticated with our backend\ntry{await apiClient.getCurrentUser();}catch(error){setConnectionStatus('âŒ Your session has expired. Please log out and log back in to connect Facebook.');setTimeout(()=>{logout();navigate('/');},3000);return;}setIsConnecting(true);setConnectionStatus('ðŸ“¦ Loading Facebook SDK...');try{// For dual app setup, start with login app\nawait loadFacebookSDK(FACEBOOK_APPS.LOGIN);if(!window.FB||typeof window.FB.login!=='function'){setConnectionStatus('âŒ Facebook SDK failed to load. Please refresh the page and try again.');setIsConnecting(false);return;}setConnectionStatus('ðŸ” Connecting to Facebook...');window.FB.login(response=>{console.debug('[FB.login] Response:',response);if(response.authResponse&&response.authResponse.accessToken){console.debug('[FB.login] accessToken:',response.authResponse.accessToken);setConnectionStatus('âœ… Facebook login successful! Fetching pages...');// Use IIFE (Immediately Invoked Function Expression) to handle async operations\n(async()=>{try{const{mappedPages,userInfo,needsPagesAuth}=await fetchPages(response.authResponse.accessToken);if(needsPagesAuth&&USE_DUAL_APPS){setConnectionStatus('âœ… Basic login successful! Now connect your pages app for page management.');setFacebookConnected(true);// Mark as connected but show pages auth button\nreturn;}if(mappedPages.length>0){var _backendResponse$data;setConnectionStatus('ðŸ”„ Connecting to backend...');const backendResponse=await connectToBackend(response.authResponse.accessToken,userInfo,mappedPages);// Update frontend state with backend response if available\nif(backendResponse!==null&&backendResponse!==void 0&&(_backendResponse$data=backendResponse.data)!==null&&_backendResponse$data!==void 0&&_backendResponse$data.pages){console.debug('[FB.login] Using pages from backend response:',backendResponse.data.pages);setAvailablePages(mappedPages);// Keep original mapping for UI\nsetConnectionStatus(\"\\u2705 Connected successfully! \".concat(backendResponse.data.pages_connected,\" pages synchronized with backend.\"));}}else{setConnectionStatus('ðŸ”„ No pages found in Facebook API. Connecting to backend to check for existing connections...');try{// Even if no pages found, try connecting to backend in case there are existing connections\nawait connectToBackend(response.authResponse.accessToken,userInfo,[]);// Check if backend has existing pages for this user\nconst existingAccounts=await apiClient.getSocialAccounts();const facebookPages=existingAccounts.filter(acc=>acc.platform==='facebook'&&acc.account_type==='page'&&acc.is_connected);if(facebookPages.length>0){// Convert backend pages to frontend format\nconst backendMappedPages=facebookPages.map(page=>{var _page$platform_data,_page$platform_data2,_page$platform_data3;return{id:page.platform_user_id,name:page.display_name,category:((_page$platform_data=page.platform_data)===null||_page$platform_data===void 0?void 0:_page$platform_data.category)||'Page',access_token:page.access_token||response.authResponse.accessToken,profilePicture:page.profile_picture_url||'',canPost:((_page$platform_data2=page.platform_data)===null||_page$platform_data2===void 0?void 0:_page$platform_data2.can_post)!==false,canComment:((_page$platform_data3=page.platform_data)===null||_page$platform_data3===void 0?void 0:_page$platform_data3.can_comment)!==false,followerCount:page.follower_count||0};});setAvailablePages(backendMappedPages);setConnectionStatus(\"\\u2705 Found \".concat(facebookPages.length,\" existing page(s) from previous connections!\"));}else{setConnectionStatus('âš ï¸ No pages found. You may need to grant page permissions or create a Facebook page first.');}}catch(backendError){console.error('[FB.login] Backend check failed:',backendError);setConnectionStatus('âš ï¸ No pages found. You may need to grant page permissions or create a Facebook page first.');}}}catch(error){console.error('[FB.login] Error in page fetching or backend connection:',error);setConnectionStatus('âŒ Error during setup: '+(error.message||'Unknown error'));setIsConnecting(false);setFacebookConnected(false);}})();}else{if(response.status==='not_authorized'){setConnectionStatus('âŒ Please authorize the app to continue and select at least one page.');}else{setConnectionStatus('âŒ Facebook login cancelled or failed');}setIsConnecting(false);console.warn('[FB.login] No accessToken found in response:',response);}},{scope:['public_profile','pages_show_list','pages_read_engagement','pages_manage_posts','pages_manage_engagement','pages_read_user_content','pages_manage_metadata'].join(','),enable_profile_selector:true,return_scopes:true,auth_type:'rerequest',display:'popup'// Force popup display\n});}catch(error){console.error('Facebook login error:',error);setConnectionStatus('âŒ Facebook login failed: '+error.message);}};// Always render something for the Facebook page\nreturn/*#__PURE__*/_jsxs(\"div\",{className:\"facebook-page-container\",style:{padding:32,maxWidth:700,margin:'0 auto'},children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Facebook Page Automation\"}),connectionStatus&&/*#__PURE__*/_jsx(\"div\",{style:{marginBottom:16,color:connectionStatus.startsWith('âœ…')?'green':connectionStatus.startsWith('âŒ')?'red':'#333'},children:connectionStatus}),USE_DUAL_APPS&&/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:16,padding:12,background:'#e0f2fe',border:'1px solid #0891b2',borderRadius:8,fontSize:14},children:[\"\\uD83D\\uDD04 \",/*#__PURE__*/_jsx(\"strong\",{children:\"Dual App Mode Active:\"}),\" Using separate apps for login (\",FACEBOOK_APPS.LOGIN,\") and page management (\",FACEBOOK_APPS.PAGES,\")\"]}),!facebookConnected&&/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:24},children:[/*#__PURE__*/_jsx(\"button\",{onClick:loginWithFacebook,disabled:isConnecting,style:{padding:'10px 24px',fontSize:18},children:isConnecting?'Connecting...':'Connect Facebook'}),/*#__PURE__*/_jsx(\"div\",{style:{marginTop:10,color:'#666'},children:\"Connect your Facebook account to manage posts, auto-replies, and more!\"})]}),facebookConnected&&availablePages.length===0&&!(USE_DUAL_APPS&&(connectionStatus.includes('Now connect your pages app')||connectionStatus.includes('Pages app connection needed')))&&/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:24,color:'#b91c1c',background:'#fff7f7',padding:16,borderRadius:8},children:[/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:8},children:[/*#__PURE__*/_jsx(\"strong\",{children:\"No Facebook Pages found.\"}),\" \",/*#__PURE__*/_jsx(\"br\",{}),\"This may be because:\",/*#__PURE__*/_jsxs(\"ul\",{style:{margin:'8px 0 0 20px',color:'#b91c1c'},children:[/*#__PURE__*/_jsx(\"li\",{children:\"You did not select any pages during Facebook login.\"}),/*#__PURE__*/_jsx(\"li\",{children:\"You denied required permissions.\"}),/*#__PURE__*/_jsx(\"li\",{children:\"Your Facebook account does not have any managed pages.\"}),/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(\"strong\",{children:\"Your Facebook app configuration is incorrect.\"})})]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{margin:'12px 0',padding:12,background:'#fef3c7',color:'#92400e',borderRadius:4,fontSize:14},children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\uD83D\\uDD27 Facebook App Setup Checklist:\"}),/*#__PURE__*/_jsxs(\"ol\",{style:{margin:'8px 0 0 20px'},children:[/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"App Type:\"}),\" Should be \\\"Consumer\\\" or \\\"Business\\\" (not just page management)\"]}),/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Use Cases:\"}),\" Add both \\\"Facebook Login\\\" AND \\\"Pages API\\\"\"]}),/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"App Review:\"}),\" Some permissions may need review for production\"]}),/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Development Mode:\"}),\" Make sure you're added as an app tester\"]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:8},children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Login App ID:\"}),\" \",FACEBOOK_APPS.LOGIN,/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"strong\",{children:\"Pages App ID:\"}),\" \",FACEBOOK_APPS.PAGES,/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"strong\",{children:\"Using Dual Apps:\"}),\" \",USE_DUAL_APPS?'Yes':'No',/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"strong\",{children:\"Current Mode:\"}),\" \",USE_DUAL_APPS?'Dual App Setup':'Single App Setup']})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:12,flexWrap:'wrap'},children:[/*#__PURE__*/_jsx(\"button\",{onClick:loginWithFacebook,style:{padding:'8px 18px',background:'#1877f2',color:'#fff',border:'none',borderRadius:4,fontWeight:600},children:\"Re-request Facebook Permissions\"}),USE_DUAL_APPS&&/*#__PURE__*/_jsx(\"button\",{onClick:loginWithPagesApp,disabled:isConnecting,style:{padding:'8px 18px',background:'#059669',color:'#fff',border:'none',borderRadius:4,fontWeight:600},children:isConnecting?'Connecting...':'Connect Pages App'}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{window.open('https://developers.facebook.com/apps/','_blank');},style:{padding:'8px 18px',background:'#6b7280',color:'#fff',border:'none',borderRadius:4,fontWeight:600},children:\"Open Facebook App Settings\"})]})]}),facebookConnected&&availablePages.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"page-select-section\",style:{marginTop:24},children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"fb-page-select\",children:/*#__PURE__*/_jsx(\"strong\",{children:\"Select a Facebook Page:\"})}),/*#__PURE__*/_jsxs(\"select\",{id:\"fb-page-select\",value:selectedPage?selectedPage.id:'',onChange:e=>{const page=availablePages.find(p=>p.id===e.target.value);if(page){setSelectedPage(page);setConnectionStatus(\"\\u2705 Page \\\"\".concat(page.name,\"\\\" selected successfully! You can now manage posts and auto-replies.\"));console.log('[Page Selection] Selected page:',page);}else{setSelectedPage(null);setConnectionStatus('âš ï¸ Please select a page to continue.');}},style:{marginLeft:8,padding:'8px 12px',borderRadius:4,border:'1px solid #ddd'},children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"-- Select Page --\"}),availablePages.map(page=>/*#__PURE__*/_jsxs(\"option\",{value:page.id,children:[page.name,\" (\",page.category,\") \",page.followerCount>0?\"- \".concat(page.followerCount,\" followers\"):'']},page.id))]}),selectedPage&&/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:12,padding:12,background:'#f0f9ff',borderRadius:8,border:'1px solid #0ea5e9'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',marginBottom:8},children:[selectedPage.profilePicture&&/*#__PURE__*/_jsx(\"img\",{src:selectedPage.profilePicture,alt:selectedPage.name,width:40,height:40,style:{borderRadius:'50%',marginRight:12}}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{style:{fontWeight:600,fontSize:16},children:selectedPage.name}),/*#__PURE__*/_jsx(\"div\",{style:{color:'#666',fontSize:14},children:selectedPage.category})]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{fontSize:14,color:'#0369a1'},children:[/*#__PURE__*/_jsxs(\"div\",{children:[\"\\u2705 Can post: \",selectedPage.canPost?'Yes':'No']}),/*#__PURE__*/_jsxs(\"div\",{children:[\"\\u2705 Can manage comments: \",selectedPage.canComment?'Yes':'No']}),selectedPage.followerCount>0&&/*#__PURE__*/_jsxs(\"div\",{children:[\"\\uD83D\\uDC65 Followers: \",selectedPage.followerCount.toLocaleString()]})]})]}),!selectedPage&&/*#__PURE__*/_jsx(\"div\",{style:{color:'#b91c1c',marginTop:8,padding:8,background:'#fef2f2',borderRadius:4},children:\"\\u26A0\\uFE0F Please select a page from the dropdown above to enable posting and auto-reply features.\"}),/*#__PURE__*/_jsxs(\"details\",{style:{marginTop:12,fontSize:13},children:[/*#__PURE__*/_jsxs(\"summary\",{children:[\"Debug: Show available pages data (\",availablePages.length,\" found)\"]}),/*#__PURE__*/_jsx(\"pre\",{style:{background:'#f3f3f3',padding:8,borderRadius:4,maxHeight:200,overflow:'auto'},children:JSON.stringify(availablePages,null,2)})]})]}),USE_DUAL_APPS&&facebookConnected&&availablePages.length===0&&(connectionStatus.includes('Now connect your pages app')||connectionStatus.includes('Pages app connection needed'))&&/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:24,padding:16,background:'#f0fdf4',border:'1px solid #16a34a',borderRadius:8},children:[/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:12},children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u2705 Basic Facebook login successful!\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"span\",{style:{color:'#15803d'},children:\"Now connect your Pages app to manage Facebook pages:\"})]}),/*#__PURE__*/_jsx(\"button\",{onClick:loginWithPagesApp,disabled:isConnecting,style:{padding:'12px 24px',background:'#16a34a',color:'#fff',border:'none',borderRadius:6,fontWeight:600,fontSize:16},children:isConnecting?'Connecting to Pages App...':'ðŸ”— Connect Facebook Pages App'})]}),facebookConnected&&selectedPage&&/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:32},children:[/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:24,padding:16,background:'#f8fafc',borderRadius:8,border:'1px solid #e2e8f0'},children:[/*#__PURE__*/_jsxs(\"h3\",{style:{margin:'0 0 12px 0',display:'flex',alignItems:'center',gap:8},children:[/*#__PURE__*/_jsx(AutoReplyIcon,{}),\"Auto-Reply to Comments\"]}),/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',alignItems:'center',gap:12},children:/*#__PURE__*/_jsxs(\"label\",{style:{display:'flex',alignItems:'center',gap:8,cursor:'pointer'},children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:autoReplyEnabled,onChange:handleAutoReplyToggle,style:{width:18,height:18}}),autoReplyEnabled?'Auto-reply is enabled':'Enable auto-reply to comments']})}),/*#__PURE__*/_jsx(\"p\",{style:{margin:'8px 0 0 0',fontSize:14,color:'#64748b'},children:\"When enabled, the bot will automatically reply to new comments on your page posts.\"})]}),/*#__PURE__*/_jsx(\"div\",{style:{marginBottom:24},children:/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',borderBottom:'2px solid #e2e8f0'},children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setActiveTab('auto'),style:{padding:'12px 24px',border:'none',background:activeTab==='auto'?'#3b82f6':'transparent',color:activeTab==='auto'?'white':'#64748b',borderRadius:'8px 8px 0 0',fontWeight:600,cursor:'pointer',display:'flex',alignItems:'center',gap:8},children:[/*#__PURE__*/_jsx(AutoIcon,{}),\"AI Auto Post\"]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setActiveTab('manual'),style:{padding:'12px 24px',border:'none',background:activeTab==='manual'?'#3b82f6':'transparent',color:activeTab==='manual'?'white':'#64748b',borderRadius:'8px 8px 0 0',fontWeight:600,cursor:'pointer',display:'flex',alignItems:'center',gap:8},children:[/*#__PURE__*/_jsx(ManualIcon,{}),\"Manual Post\"]})]})}),activeTab==='auto'&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"h3\",{style:{marginBottom:16,display:'flex',alignItems:'center',gap:8},children:[/*#__PURE__*/_jsx(SparkleIcon,{}),\"AI-Generated Post\"]}),/*#__PURE__*/_jsx(\"p\",{style:{color:'#64748b',marginBottom:16},children:\"Describe what you want to post about, and AI will generate engaging content for you.\"}),/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:16},children:[/*#__PURE__*/_jsx(\"label\",{style:{display:'block',marginBottom:8,fontWeight:600},children:\"Content Prompt:\"}),/*#__PURE__*/_jsx(\"textarea\",{name:\"prompt\",value:autoFormData.prompt,onChange:handleAutoInputChange,placeholder:\"e.g., 'Create a motivational post about entrepreneurship' or 'Write about our latest product launch'\",style:{width:'100%',minHeight:100,padding:12,border:'1px solid #d1d5db',borderRadius:8,fontSize:14,resize:'vertical'}})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:generatePostContent,disabled:autoFormData.isGenerating||!autoFormData.prompt.trim(),style:{padding:'12px 24px',background:autoFormData.isGenerating?'#94a3b8':'#10b981',color:'white',border:'none',borderRadius:8,fontWeight:600,cursor:autoFormData.isGenerating?'not-allowed':'pointer',display:'flex',alignItems:'center',gap:8,marginBottom:16},children:[/*#__PURE__*/_jsx(SparkleIcon,{}),autoFormData.isGenerating?'Generating...':'Generate Content']}),autoFormData.generatedContent&&/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:16},children:[/*#__PURE__*/_jsx(\"label\",{style:{display:'block',marginBottom:8,fontWeight:600},children:\"Generated Content:\"}),/*#__PURE__*/_jsx(\"textarea\",{value:autoFormData.generatedContent,onChange:e=>setAutoFormData(prev=>_objectSpread(_objectSpread({},prev),{},{generatedContent:e.target.value})),style:{width:'100%',minHeight:120,padding:12,border:'1px solid #d1d5db',borderRadius:8,fontSize:14,resize:'vertical'}}),/*#__PURE__*/_jsx(\"p\",{style:{fontSize:12,color:'#64748b',marginTop:4},children:\"You can edit the generated content before posting.\"})]})]}),activeTab==='manual'&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"h3\",{style:{marginBottom:16,display:'flex',alignItems:'center',gap:8},children:[/*#__PURE__*/_jsx(ManualIcon,{}),\"Manual Post\"]}),/*#__PURE__*/_jsx(\"p\",{style:{color:'#64748b',marginBottom:16},children:\"Create and publish your own custom post content.\"}),/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:16},children:[/*#__PURE__*/_jsx(\"label\",{style:{display:'block',marginBottom:8,fontWeight:600},children:\"Post Content:\"}),/*#__PURE__*/_jsx(\"textarea\",{name:\"message\",value:manualFormData.message,onChange:handleManualInputChange,placeholder:\"Write your post content here...\",style:{width:'100%',minHeight:120,padding:12,border:'1px solid #d1d5db',borderRadius:8,fontSize:14,resize:'vertical'}})]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:16},children:[/*#__PURE__*/_jsx(\"label\",{style:{display:'block',marginBottom:8,fontWeight:600},children:\"Media Type:\"}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:12},children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleMediaTypeChange('none',activeTab),style:{padding:'8px 16px',border:'1px solid #d1d5db',background:(activeTab==='auto'?autoFormData.mediaType:manualFormData.mediaType)==='none'?'#3b82f6':'white',color:(activeTab==='auto'?autoFormData.mediaType:manualFormData.mediaType)==='none'?'white':'#374151',borderRadius:6,cursor:'pointer',fontWeight:500},children:\"Text Only\"}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>handleMediaTypeChange('photo',activeTab),style:{padding:'8px 16px',border:'1px solid #d1d5db',background:(activeTab==='auto'?autoFormData.mediaType:manualFormData.mediaType)==='photo'?'#3b82f6':'white',color:(activeTab==='auto'?autoFormData.mediaType:manualFormData.mediaType)==='photo'?'white':'#374151',borderRadius:6,cursor:'pointer',fontWeight:500,display:'flex',alignItems:'center',gap:4},children:[/*#__PURE__*/_jsx(ImageIcon,{}),\"Photo\"]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>handleMediaTypeChange('video',activeTab),style:{padding:'8px 16px',border:'1px solid #d1d5db',background:(activeTab==='auto'?autoFormData.mediaType:manualFormData.mediaType)==='video'?'#3b82f6':'white',color:(activeTab==='auto'?autoFormData.mediaType:manualFormData.mediaType)==='video'?'white':'#374151',borderRadius:6,cursor:'pointer',fontWeight:500,display:'flex',alignItems:'center',gap:4},children:[/*#__PURE__*/_jsx(VideoIcon,{}),\"Video\"]})]})]}),(activeTab==='auto'&&autoFormData.mediaType!=='none'||activeTab==='manual'&&manualFormData.mediaType!=='none')&&/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:16},children:[/*#__PURE__*/_jsxs(\"label\",{style:{display:'block',marginBottom:8,fontWeight:600},children:[\"Upload \",activeTab==='auto'?autoFormData.mediaType:manualFormData.mediaType,\":\"]}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",name:\"mediaFile\",accept:activeTab==='auto'?autoFormData.mediaType==='photo'?'image/*':'video/*':manualFormData.mediaType==='photo'?'image/*':'video/*',onChange:activeTab==='auto'?handleAutoInputChange:handleManualInputChange,style:{width:'100%',padding:8,border:'1px solid #d1d5db',borderRadius:6}})]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:24},children:[/*#__PURE__*/_jsxs(\"button\",{style:{padding:'12px 32px',background:isPublishing?'#94a3b8':'#1877f2',color:'white',border:'none',borderRadius:8,fontWeight:600,cursor:isPublishing?'not-allowed':'pointer',fontSize:16,display:'flex',alignItems:'center',gap:8,opacity:isPublishing||!selectedPage||activeTab==='auto'&&!autoFormData.generatedContent.trim()||activeTab==='manual'&&!manualFormData.message.trim()?0.6:1},onClick:publishPost,disabled:isPublishing||!selectedPage||activeTab==='auto'&&!autoFormData.generatedContent.trim()||activeTab==='manual'&&!manualFormData.message.trim(),children:[/*#__PURE__*/_jsx(RocketIcon,{}),isPublishing?'Publishing...':'Publish Post']}),/*#__PURE__*/_jsx(\"p\",{style:{fontSize:14,color:'#64748b',marginTop:8},children:!selectedPage?'Please select a page first':activeTab==='auto'&&!autoFormData.generatedContent.trim()?'Generate content first':activeTab==='manual'&&!manualFormData.message.trim()?'Enter your message first':'Ready to publish to your Facebook page'})]})]})]});}export default FacebookPage;","map":{"version":3,"names":["React","useState","useCallback","useNavigate","useAuth","apiClient","jsx","_jsx","jsxs","_jsxs","FacebookPage","navigate","logout","isConnecting","setIsConnecting","connectionStatus","setConnectionStatus","selectedPage","setSelectedPage","availablePages","setAvailablePages","facebookConnected","setFacebookConnected","autoReplyEnabled","setAutoReplyEnabled","activeTab","setActiveTab","autoFormData","setAutoFormData","prompt","mediaType","mediaFile","generatedContent","isGenerating","manualFormData","setManualFormData","message","isPublishing","setIsPublishing","fetchPages","accessToken","console","debug","USE_DUAL_APPS","mappedPages","userInfo","_permissionsResponse$","permissionsResponse","Promise","resolve","reject","window","FB","api","access_token","response","error","Error","grantedPermissions","data","filter","p","status","map","permission","includes","requiredPermissions","missingPermissions","length","concat","join","fields","pagesResponse","JSON","stringify","code","pages","page","_page$picture","_page$picture$data","tasks","canPost","canComment","id","name","category","profilePicture","picture","url","followerCount","fan_count","email","isUserProfile","needsPagesAuth","connectToBackend","pagesCount","pagesData","connectFacebook","ImageIcon","width","height","viewBox","fill","stroke","strokeWidth","children","x","y","rx","ry","cx","cy","r","points","AutoReplyIcon","d","RocketIcon","AutoIcon","ManualIcon","VideoIcon","SparkleIcon","cleanupFacebookSDK","existingScript","document","getElementById","remove","fbAsyncInit","FACEBOOK_APPS","LOGIN","process","env","REACT_APP_FACEBOOK_APP_ID","PAGES","loadFacebookSDK","appId","arguments","undefined","init","cookie","xfbml","version","CURRENT_FB_APP_ID","script","createElement","src","async","defer","crossOrigin","onerror","body","appendChild","handleAutoInputChange","e","value","files","target","prev","_objectSpread","handleManualInputChange","handleMediaTypeChange","type","formType","generatePostContent","trim","generateContent","content","handleAutoReplyToggle","newState","toggleAutoReply","publishPost","isAutoMode","postTextOnly","postWithMedia","file","fileData","fileToBase64","caption","source","description","reader","FileReader","readAsDataURL","onload","result","useEffect","urlParams","URLSearchParams","location","hash","substring","get","state","opener","postMessage","origin","close","history","replaceState","title","pathname","loginWithPagesApp","pagesAuthUrl","encodeURIComponent","popup","open","handleMessage","event","removeEventListener","addEventListener","loginWithFacebook","protocol","hostname","getCurrentUser","setTimeout","login","authResponse","_backendResponse$data","backendResponse","pages_connected","existingAccounts","getSocialAccounts","facebookPages","acc","platform","account_type","is_connected","backendMappedPages","_page$platform_data","_page$platform_data2","_page$platform_data3","platform_user_id","display_name","platform_data","profile_picture_url","can_post","can_comment","follower_count","backendError","warn","scope","enable_profile_selector","return_scopes","auth_type","display","className","style","padding","maxWidth","margin","marginBottom","color","startsWith","background","border","borderRadius","fontSize","onClick","disabled","marginTop","gap","flexWrap","fontWeight","htmlFor","onChange","find","log","marginLeft","alignItems","alt","marginRight","toLocaleString","maxHeight","overflow","cursor","checked","borderBottom","placeholder","minHeight","resize","accept","opacity"],"sources":["F:/Projects/Automation Dashboard/frontend/src/components/FacebookPage.js"],"sourcesContent":["import React, { useState, useCallback } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { useAuth } from '../contexts/AuthContext';\nimport apiClient from '../services/apiClient';\nimport './SocialMediaPage.css';\n\nfunction FacebookPage() {\n  const navigate = useNavigate();\n  const { logout } = useAuth();\n  const [isConnecting, setIsConnecting] = useState(false);\n  const [connectionStatus, setConnectionStatus] = useState('');\n  \n  // Facebook OAuth states\n  const [selectedPage, setSelectedPage] = useState(null);\nconst [availablePages, setAvailablePages] = useState([]); // Store all fetched pages\n  const [facebookConnected, setFacebookConnected] = useState(false);\n  \n  // Auto-reply toggle state\n  const [autoReplyEnabled, setAutoReplyEnabled] = useState(false);\n  \n  // Tab selection state\n  const [activeTab, setActiveTab] = useState('auto');\n  \n  // Auto post states\n  const [autoFormData, setAutoFormData] = useState({\n    prompt: '',\n    mediaType: 'none', // 'none', 'photo', 'video'\n    mediaFile: null,\n    generatedContent: '',\n    isGenerating: false\n  });\n  \n  // Manual post states\n  const [manualFormData, setManualFormData] = useState({\n    message: '',\n    mediaType: 'none',\n    mediaFile: null\n  });\n\n  // Publishing state\n  const [isPublishing, setIsPublishing] = useState(false);\n\n  // fetchPages function\n  const fetchPages = useCallback(async (accessToken) => {\n    console.debug('[fetchPages] Called with accessToken:', accessToken);\n    console.debug('[fetchPages] Using dual apps:', USE_DUAL_APPS);\n    \n    if (!accessToken) {\n      setConnectionStatus('âŒ No Facebook access token found. Please try reconnecting.');\n      setIsConnecting(false);\n      setFacebookConnected(false);\n      return { mappedPages: [], userInfo: null };\n    }\n    \n    try {\n      // If using dual apps, get pages access token via direct API call\n      if (USE_DUAL_APPS) {\n        console.debug('[fetchPages] Dual app mode - requesting pages access via direct API...');\n        setConnectionStatus('ðŸ”„ Getting page permissions...');\n        \n        // For now, try using the original access token but with pages app API calls\n        // This is a simplified approach that might work if the user has already granted permissions\n        console.debug('[fetchPages] Using original access token for pages API calls');\n        setConnectionStatus('ðŸ”„ Attempting to fetch pages with current permissions...');\n      }\n      // Check what permissions we actually have\n      const permissionsResponse = await new Promise((resolve, reject) => {\n        window.FB.api('/me/permissions', { access_token: accessToken }, (response) => {\n          console.debug('[FB.api] /me/permissions response:', response);\n          if (response.error) reject(new Error(response.error.message));\n          else resolve(response);\n        });\n      });\n      \n      const grantedPermissions = permissionsResponse.data?.filter(p => p.status === 'granted').map(p => p.permission) || [];\n      console.debug('[fetchPages] Granted permissions:', grantedPermissions);\n      console.debug('[fetchPages] All permissions (including declined):', permissionsResponse.data);\n      \n      // In dual app mode, we expect basic permissions only\n      if (USE_DUAL_APPS) {\n        console.debug('[fetchPages] Dual app mode - checking if we have basic login permissions');\n        if (grantedPermissions.includes('public_profile')) {\n          console.debug('[fetchPages] Basic login successful, need to connect pages app');\n          throw new Error('NEED_PAGES_AUTH'); // Trigger pages auth flow\n        }\n      } else {\n        // Check for required permissions in single app mode\n        const requiredPermissions = ['pages_show_list', 'pages_manage_posts'];\n        const missingPermissions = requiredPermissions.filter(p => !grantedPermissions.includes(p));\n        \n        if (missingPermissions.length > 0) {\n          setConnectionStatus(`âŒ Missing permissions: ${missingPermissions.join(', ')}. Your app needs \"Pages API\" permissions.`);\n          console.error('[fetchPages] Missing required permissions:', missingPermissions);\n        }\n      }\n      \n      // Get user info\n      const userInfo = await new Promise((resolve, reject) => {\n        window.FB.api('/me', { access_token: accessToken, fields: 'id,name,email' }, (response) => {\n          console.debug('[FB.api] /me response:', response);\n          if (response.error) reject(new Error(response.error.message));\n          else resolve(response);\n        });\n      });\n      \n      // Get user's pages with extended permissions\n      const pagesResponse = await new Promise((resolve, reject) => {\n        window.FB.api('/me/accounts', {\n          access_token: accessToken,\n          fields: 'id,name,category,access_token,picture,fan_count,tasks'\n        }, (response) => {\n          // Debug log for troubleshooting\n          console.debug('[FB.api] /me/accounts response:', response);\n          console.debug('[FB.api] /me/accounts full response object:', JSON.stringify(response, null, 2));\n          if (response.error) {\n            console.error('[FB.api] /me/accounts error details:', response.error);\n            reject(new Error(`${response.error.message} (Code: ${response.error.code})`));\n          } else {\n            resolve(response);\n          }\n        });\n      });\n      const pages = pagesResponse.data || [];\n      const mappedPages = pages.map(page => {\n        // Determine permissions from tasks array\n        const tasks = page.tasks || [];\n        const canPost = tasks.includes('CREATE_CONTENT') || tasks.includes('MANAGE');\n        const canComment = tasks.includes('MODERATE') || tasks.includes('MANAGE');\n        \n        return {\n          id: page.id,\n          name: page.name,\n          category: page.category || 'Page',\n          access_token: page.access_token,\n          profilePicture: page.picture?.data?.url || '',\n          canPost: canPost,\n          canComment: canComment,\n          followerCount: page.fan_count || 0,\n          tasks: tasks // Keep tasks for debugging\n        };\n      });\n      setAvailablePages(mappedPages);\n      // Page selection logic\n      if (mappedPages.length === 1) {\n        setSelectedPage(mappedPages[0]);\n        setConnectionStatus(`âœ… Connected successfully! 1 page found.`);\n      } else if (mappedPages.length > 1) {\n        setSelectedPage(null); // Prompt user to select a page\n        setConnectionStatus(`âœ… Connected successfully! ${mappedPages.length} pages found. Please select a page below.`);\n      } else {\n        // Fallback to user profile if no pages available\n        setSelectedPage({\n          id: userInfo.id,\n          name: userInfo.name,\n          access_token: accessToken,\n          category: 'Personal Profile',\n          profilePicture: '',\n          email: userInfo.email || '',\n          isUserProfile: true,\n          canPost: true,\n          canComment: true,\n          followerCount: 0\n        });\n        setConnectionStatus('âœ… Connected as personal profile (no pages found).');\n      }\n      setFacebookConnected(true);\n      setIsConnecting(false);\n      return { mappedPages, userInfo };\n          } catch (error) {\n        console.error('Facebook API error:', error);\n        \n        // If dual app mode and we get the specific pages auth trigger\n        if (USE_DUAL_APPS && (error.message === 'NEED_PAGES_AUTH' || error.message.includes('permissions'))) {\n          console.debug('[fetchPages] Dual app mode - basic login successful, need pages auth');\n          setConnectionStatus('âœ… Basic login successful! Now connect your pages app for page management.');\n          setIsConnecting(false);\n          setFacebookConnected(true); // Mark as connected to show the pages auth button\n          return { mappedPages: [], userInfo: null, needsPagesAuth: true };\n        }\n        \n        // If dual app mode but other error, still try pages auth\n        if (USE_DUAL_APPS) {\n          console.debug('[fetchPages] Dual app mode - treating error as need for pages auth');\n          setConnectionStatus('âœ… Basic login successful! Pages app connection needed for page management.');\n          setIsConnecting(false);\n          setFacebookConnected(true); // Mark as connected to show the pages auth button\n          return { mappedPages: [], userInfo: null, needsPagesAuth: true };\n        }\n        \n        setConnectionStatus('âŒ Failed to get Facebook data: ' + (error.message || 'Unknown error'));\n        setIsConnecting(false);\n        setFacebookConnected(false);\n        return { mappedPages: [], userInfo: null };\n      }\n  }, [USE_DUAL_APPS]);\n\n  // connectToBackend function\n  const connectToBackend = async (accessToken, userInfo, mappedPages) => {\n    try {\n      console.debug('[connectToBackend] Connecting to backend with:', {\n        userInfo: userInfo?.id,\n        pagesCount: mappedPages.length,\n        pagesData: mappedPages\n      });\n      \n      const response = await apiClient.connectFacebook(\n        accessToken,\n        userInfo?.id,\n        mappedPages\n      );\n      \n      console.debug('[connectToBackend] Backend response:', response);\n      setConnectionStatus('âœ… Successfully connected to backend!');\n      return response;\n    } catch (error) {\n      console.error('Backend connection error:', error);\n      setConnectionStatus('âŒ Backend connection failed: ' + (error.message || 'Unknown error'));\n      throw error;\n    }\n  };\n\n  // Icon Components\n\n  const ImageIcon = () => (\n    <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n      <rect x=\"3\" y=\"3\" width=\"18\" height=\"18\" rx=\"2\" ry=\"2\"></rect>\n      <circle cx=\"8.5\" cy=\"8.5\" r=\"1.5\"></circle>\n      <polyline points=\"21,15 16,10 5,21\"></polyline>\n    </svg>\n  );\n\n  const AutoReplyIcon = () => (\n    <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n      <path d=\"M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z\"></path>\n    </svg>\n  );\n\n  const RocketIcon = () => (\n    <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n      <path d=\"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z\"></path>\n      <path d=\"M12 15l-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z\"></path>\n      <path d=\"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0\"></path>\n      <path d=\"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5\"></path>\n    </svg>\n  );\n\n  const AutoIcon = () => (\n    <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n      <path d=\"M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5\"/>\n    </svg>\n  );\n\n  const ManualIcon = () => (\n    <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n      <path d=\"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z\"/>\n    </svg>\n  );\n\n  const VideoIcon = () => (\n    <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n      <polygon points=\"23 7 16 12 23 17 23 7\"></polygon>\n      <rect x=\"1\" y=\"5\" width=\"15\" height=\"14\" rx=\"2\" ry=\"2\"></rect>\n    </svg>\n  );\n\n  const SparkleIcon = () => (\n    <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n      <path d=\"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.582a.5.5 0 0 1 0 .962L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0L9.937 15.5Z\"/>\n    </svg>\n  );\n\n  // Clean up any existing Facebook SDK instances\n  const cleanupFacebookSDK = () => {\n    const existingScript = document.getElementById('facebook-jssdk');\n    if (existingScript) {\n      existingScript.remove();\n    }\n    \n    if (window.FB) {\n      delete window.FB;\n    }\n    \n    if (window.fbAsyncInit) {\n      delete window.fbAsyncInit;\n    }\n  };\n\n  // Facebook App Configuration - SINGLE APP SETUP\n  const FACEBOOK_APPS = {\n    LOGIN: process.env.REACT_APP_FACEBOOK_APP_ID || '1526961221410200',    // Using the page management app for everything\n    PAGES: process.env.REACT_APP_FACEBOOK_APP_ID || '1526961221410200'     // Same app ID\n  };\n  \n  const USE_DUAL_APPS = false; // Force single app mode\n\n  // Load Facebook SDK function\n  const loadFacebookSDK = (appId = FACEBOOK_APPS.LOGIN) => {\n    return new Promise((resolve, reject) => {\n      cleanupFacebookSDK();\n      \n      window.fbAsyncInit = function () {\n        try {\n          console.debug('[loadFacebookSDK] Initializing with App ID:', appId);\n          \n          window.FB.init({\n            appId: appId,\n            cookie: true,\n            xfbml: true,\n            version: 'v19.0'\n          });\n\n          // Store current app ID for reference\n          window.CURRENT_FB_APP_ID = appId;\n          resolve();\n        } catch (error) {\n          console.error('Facebook SDK initialization error:', error);\n          reject(error);\n        }\n      };\n\n      const script = document.createElement('script');\n      script.id = 'facebook-jssdk';\n      script.src = 'https://connect.facebook.net/en_US/sdk.js';\n      script.async = true;\n      script.defer = true;\n      script.crossOrigin = 'anonymous';\n\n      script.onerror = () => {\n        reject(new Error('Failed to load Facebook SDK script'));\n      };\n\n      document.body.appendChild(script);\n    });\n  };\n\n  const handleAutoInputChange = (e) => {\n    const { name, value, files } = e.target;\n    setAutoFormData(prev => ({\n      ...prev,\n      [name]: files ? files[0] : value\n    }));\n  };\n\n  const handleManualInputChange = (e) => {\n    const { name, value, files } = e.target;\n    setManualFormData(prev => ({\n      ...prev,\n      [name]: files ? files[0] : value\n    }));\n  };\n\n  const handleMediaTypeChange = (type, formType) => {\n    if (formType === 'auto') {\n      setAutoFormData(prev => ({\n        ...prev,\n        mediaType: type,\n        mediaFile: null\n      }));\n    } else {\n      setManualFormData(prev => ({\n        ...prev,\n        mediaType: type,\n        mediaFile: null\n      }));\n    }\n  };\n\n  // Generate content using Groq API\n  const generatePostContent = async () => {\n    if (!autoFormData.prompt.trim()) {\n      setConnectionStatus('âŒ Please enter a prompt for AI generation');\n      return;\n    }\n\n    setAutoFormData(prev => ({ ...prev, isGenerating: true }));\n    setConnectionStatus('ðŸ¤– Generating content with AI...');\n\n    try {\n      // Call your backend API to use Groq\n      const response = await apiClient.generateContent(autoFormData.prompt);\n      \n      setAutoFormData(prev => ({\n        ...prev,\n        generatedContent: response.content,\n        isGenerating: false\n      }));\n      \n      setConnectionStatus('âœ… Content generated successfully!');\n    } catch (error) {\n      console.error('Content generation error:', error);\n      setConnectionStatus('âŒ Failed to generate content: ' + (error.message || 'Unknown error'));\n      setAutoFormData(prev => ({ ...prev, isGenerating: false }));\n    }\n  };\n\n  // UPDATED: Replace Make.com auto-reply webhook with backend API\n  const handleAutoReplyToggle = async () => {\n    const newState = !autoReplyEnabled;\n    setAutoReplyEnabled(newState);\n    \n    try {\n      setConnectionStatus('ðŸ”„ Updating auto-reply setting...');\n      \n      await apiClient.toggleAutoReply(\n        selectedPage?.id || 'user_profile',\n        newState,\n        'Thank you for your comment! We\\'ll get back to you soon.'\n      );\n\n      setConnectionStatus(`${newState ? 'âœ…' : 'âŒ'} Auto-reply ${newState ? 'enabled' : 'disabled'}`);\n    } catch (error) {\n      console.error('Auto-reply toggle error:', error);\n      setConnectionStatus('âŒ Failed to update auto-reply setting');\n      setAutoReplyEnabled(!newState); // Revert on error\n    }\n  };\n\n  // Publish post to Facebook\n  const publishPost = async () => {\n    if (!selectedPage) {\n      setConnectionStatus('âŒ Please select a page first');\n      return;\n    }\n\n    // Determine content based on active tab\n    const isAutoMode = activeTab === 'auto';\n    const content = isAutoMode ? autoFormData.generatedContent : manualFormData.message;\n    const mediaType = isAutoMode ? autoFormData.mediaType : manualFormData.mediaType;\n    const mediaFile = isAutoMode ? autoFormData.mediaFile : manualFormData.mediaFile;\n\n    // Validation\n    if (!content || content.trim() === '') {\n      setConnectionStatus('âŒ Please enter some content for your post');\n      return;\n    }\n\n    if (mediaType !== 'none' && !mediaFile) {\n      setConnectionStatus('âŒ Please select a media file to upload');\n      return;\n    }\n\n    try {\n      setIsPublishing(true);\n      setConnectionStatus('ðŸ”„ Publishing post to Facebook...');\n      \n      // If no media, just post text\n      if (mediaType === 'none') {\n        await postTextOnly(content);\n      } else {\n        await postWithMedia(content, mediaFile, mediaType);\n      }\n\n      setConnectionStatus('âœ… Post published successfully!');\n      \n      // Clear form data after successful post\n      if (isAutoMode) {\n        setAutoFormData(prev => ({\n          ...prev,\n          prompt: '',\n          generatedContent: '',\n          mediaFile: null,\n          mediaType: 'none'\n        }));\n      } else {\n        setManualFormData(prev => ({\n          ...prev,\n          message: '',\n          mediaFile: null,\n          mediaType: 'none'\n        }));\n      }\n\n    } catch (error) {\n      console.error('Post publishing error:', error);\n      setConnectionStatus('âŒ Failed to publish post: ' + (error.message || 'Unknown error'));\n    } finally {\n      setIsPublishing(false);\n    }\n  };\n\n  // Post text-only content\n  const postTextOnly = async (message) => {\n    return new Promise((resolve, reject) => {\n      window.FB.api(`/${selectedPage.id}/feed`, 'POST', {\n        message: message,\n        access_token: selectedPage.access_token\n      }, (response) => {\n        console.debug('[FB.api] Post response:', response);\n        if (response.error) {\n          reject(new Error(`${response.error.message} (Code: ${response.error.code})`));\n        } else {\n          resolve(response);\n        }\n      });\n    });\n  };\n\n  // Post content with media (photo or video)\n  const postWithMedia = async (message, file, mediaType) => {\n    // Convert file to base64 for Facebook API\n    const fileData = await fileToBase64(file);\n    \n    if (mediaType === 'photo') {\n      return new Promise((resolve, reject) => {\n        window.FB.api(`/${selectedPage.id}/photos`, 'POST', {\n          caption: message,\n          source: fileData,\n          access_token: selectedPage.access_token\n        }, (response) => {\n          console.debug('[FB.api] Photo post response:', response);\n          if (response.error) {\n            reject(new Error(`${response.error.message} (Code: ${response.error.code})`));\n          } else {\n            resolve(response);\n          }\n        });\n      });\n    } else if (mediaType === 'video') {\n      return new Promise((resolve, reject) => {\n        window.FB.api(`/${selectedPage.id}/videos`, 'POST', {\n          description: message,\n          source: fileData,\n          access_token: selectedPage.access_token\n        }, (response) => {\n          console.debug('[FB.api] Video post response:', response);\n          if (response.error) {\n            reject(new Error(`${response.error.message} (Code: ${response.error.code})`));\n          } else {\n            resolve(response);\n          }\n        });\n      });\n    }\n  };\n\n  // Helper function to convert file to base64\n  const fileToBase64 = (file) => {\n    return new Promise((resolve, reject) => {\n      const reader = new FileReader();\n      reader.readAsDataURL(file);\n      reader.onload = () => resolve(reader.result);\n      reader.onerror = (error) => reject(error);\n    });\n  };\n\n  // Check URL for pages auth callback\n  React.useEffect(() => {\n    const urlParams = new URLSearchParams(window.location.hash.substring(1));\n    const accessToken = urlParams.get('access_token');\n    const state = urlParams.get('state');\n    \n    if (accessToken && state === 'pages_auth') {\n      console.debug('[useEffect] Found pages auth callback in URL');\n      // Send message to opener window (popup parent)\n      if (window.opener) {\n        window.opener.postMessage({\n          type: 'FACEBOOK_PAGES_AUTH',\n          accessToken: accessToken\n        }, window.location.origin);\n        window.close();\n      } else {\n        // Direct navigation case\n        (async () => {\n          setConnectionStatus('ðŸ”„ Processing pages authentication...');\n          const { mappedPages, userInfo } = await fetchPages(accessToken);\n          if (mappedPages.length > 0) {\n            await connectToBackend(accessToken, userInfo, mappedPages);\n          }\n        })();\n      }\n      \n      // Clean up URL\n      window.history.replaceState({}, document.title, window.location.pathname);\n    }\n  }, [fetchPages]);\n\n  // Manual Pages App Login for Dual App Setup\n  const loginWithPagesApp = async () => {\n    setIsConnecting(true);\n    setConnectionStatus('ðŸ” Connecting to Facebook Pages App...');\n    \n    try {\n      // Direct redirect to pages app OAuth\n      const pagesAuthUrl = `https://www.facebook.com/v19.0/dialog/oauth?` +\n        `client_id=${FACEBOOK_APPS.PAGES}&` +\n        `redirect_uri=${encodeURIComponent(window.location.origin)}&` +\n        `scope=pages_show_list,pages_manage_posts,pages_manage_engagement,pages_read_engagement&` +\n        `response_type=token&` +\n        `state=pages_auth&` +\n        `display=popup`;\n      \n      // Open in popup\n      const popup = window.open(pagesAuthUrl, 'facebookPagesAuth', 'width=600,height=400');\n      \n      // Listen for popup message\n      const handleMessage = (event) => {\n        if (event.origin !== window.location.origin) return;\n        \n        if (event.data.type === 'FACEBOOK_PAGES_AUTH') {\n          window.removeEventListener('message', handleMessage);\n          popup.close();\n          \n          if (event.data.accessToken) {\n            console.debug('[loginWithPagesApp] Got pages access token:', event.data.accessToken);\n            // Use the pages access token to fetch pages\n            (async () => {\n              const { mappedPages, userInfo } = await fetchPages(event.data.accessToken);\n              if (mappedPages.length > 0) {\n                await connectToBackend(event.data.accessToken, userInfo, mappedPages);\n              }\n            })();\n          } else {\n            setConnectionStatus('âŒ Failed to get pages app permissions');\n            setIsConnecting(false);\n          }\n        }\n      };\n      \n      window.addEventListener('message', handleMessage);\n      \n    } catch (error) {\n      console.error('Pages app login error:', error);\n      setConnectionStatus('âŒ Pages app login failed: ' + error.message);\n      setIsConnecting(false);\n    }\n  };\n\n  const loginWithFacebook = async () => {\n    // Check HTTPS requirement first\n    if (window.location.protocol !== 'https:' && window.location.hostname !== 'localhost') {\n      setConnectionStatus('âŒ Facebook login requires HTTPS. Please use https://localhost:3001 or deploy with HTTPS');\n      return;\n    }\n\n    // Check if user is still authenticated with our backend\n    try {\n      await apiClient.getCurrentUser();\n    } catch (error) {\n      setConnectionStatus('âŒ Your session has expired. Please log out and log back in to connect Facebook.');\n      setTimeout(() => {\n        logout();\n        navigate('/');\n      }, 3000);\n      return;\n    }\n\n    setIsConnecting(true);\n    setConnectionStatus('ðŸ“¦ Loading Facebook SDK...');\n\n    try {\n      // For dual app setup, start with login app\n      await loadFacebookSDK(FACEBOOK_APPS.LOGIN);\n\n      if (!window.FB || typeof window.FB.login !== 'function') {\n        setConnectionStatus('âŒ Facebook SDK failed to load. Please refresh the page and try again.');\n        setIsConnecting(false);\n        return;\n      }\n\n      setConnectionStatus('ðŸ” Connecting to Facebook...');\n      \n      window.FB.login((response) => {\n        console.debug('[FB.login] Response:', response);\n        if (response.authResponse && response.authResponse.accessToken) {\n          console.debug('[FB.login] accessToken:', response.authResponse.accessToken);\n          setConnectionStatus('âœ… Facebook login successful! Fetching pages...');\n          \n          // Use IIFE (Immediately Invoked Function Expression) to handle async operations\n          (async () => {\n            try {\n              const { mappedPages, userInfo, needsPagesAuth } = await fetchPages(response.authResponse.accessToken);\n              \n              if (needsPagesAuth && USE_DUAL_APPS) {\n                setConnectionStatus('âœ… Basic login successful! Now connect your pages app for page management.');\n                setFacebookConnected(true); // Mark as connected but show pages auth button\n                return;\n              }\n              \n              if (mappedPages.length > 0) {\n                setConnectionStatus('ðŸ”„ Connecting to backend...');\n                const backendResponse = await connectToBackend(response.authResponse.accessToken, userInfo, mappedPages);\n                \n                // Update frontend state with backend response if available\n                if (backendResponse?.data?.pages) {\n                  console.debug('[FB.login] Using pages from backend response:', backendResponse.data.pages);\n                  setAvailablePages(mappedPages); // Keep original mapping for UI\n                  setConnectionStatus(`âœ… Connected successfully! ${backendResponse.data.pages_connected} pages synchronized with backend.`);\n                }\n              } else {\n                setConnectionStatus('ðŸ”„ No pages found in Facebook API. Connecting to backend to check for existing connections...');\n                \n                try {\n                  // Even if no pages found, try connecting to backend in case there are existing connections\n                  await connectToBackend(response.authResponse.accessToken, userInfo, []);\n                  \n                  // Check if backend has existing pages for this user\n                  const existingAccounts = await apiClient.getSocialAccounts();\n                  const facebookPages = existingAccounts.filter(acc => \n                    acc.platform === 'facebook' && acc.account_type === 'page' && acc.is_connected\n                  );\n                  \n                  if (facebookPages.length > 0) {\n                    // Convert backend pages to frontend format\n                    const backendMappedPages = facebookPages.map(page => ({\n                      id: page.platform_user_id,\n                      name: page.display_name,\n                      category: page.platform_data?.category || 'Page',\n                      access_token: page.access_token || response.authResponse.accessToken,\n                      profilePicture: page.profile_picture_url || '',\n                      canPost: page.platform_data?.can_post !== false,\n                      canComment: page.platform_data?.can_comment !== false,\n                      followerCount: page.follower_count || 0\n                    }));\n                    \n                    setAvailablePages(backendMappedPages);\n                    setConnectionStatus(`âœ… Found ${facebookPages.length} existing page(s) from previous connections!`);\n                  } else {\n                    setConnectionStatus('âš ï¸ No pages found. You may need to grant page permissions or create a Facebook page first.');\n                  }\n                } catch (backendError) {\n                  console.error('[FB.login] Backend check failed:', backendError);\n                  setConnectionStatus('âš ï¸ No pages found. You may need to grant page permissions or create a Facebook page first.');\n                }\n              }\n            } catch (error) {\n              console.error('[FB.login] Error in page fetching or backend connection:', error);\n              setConnectionStatus('âŒ Error during setup: ' + (error.message || 'Unknown error'));\n              setIsConnecting(false);\n              setFacebookConnected(false);\n            }\n          })();\n        } else {\n          if (response.status === 'not_authorized') {\n            setConnectionStatus('âŒ Please authorize the app to continue and select at least one page.');\n          } else {\n            setConnectionStatus('âŒ Facebook login cancelled or failed');\n          }\n          setIsConnecting(false);\n          console.warn('[FB.login] No accessToken found in response:', response);\n        }\n      }, {\n        scope: [\n          'public_profile',\n          'pages_show_list',\n          'pages_read_engagement', \n          'pages_manage_posts',\n          'pages_manage_engagement',\n          'pages_read_user_content',\n          'pages_manage_metadata'\n        ].join(','),\n        enable_profile_selector: true,\n        return_scopes: true,\n        auth_type: 'rerequest',\n        display: 'popup'  // Force popup display\n      });\n    } catch (error) {\n      console.error('Facebook login error:', error);\n      setConnectionStatus('âŒ Facebook login failed: ' + error.message);\n    }\n  };\n\n  // Always render something for the Facebook page\n  return (\n    <div className=\"facebook-page-container\" style={{ padding: 32, maxWidth: 700, margin: '0 auto' }}>\n      <h2>Facebook Page Automation</h2>\n      {/* Show connection status */}\n      {connectionStatus && (\n        <div style={{ marginBottom: 16, color: connectionStatus.startsWith('âœ…') ? 'green' : connectionStatus.startsWith('âŒ') ? 'red' : '#333' }}>\n          {connectionStatus}\n        </div>\n      )}\n      \n      {/* Show dual app mode indicator */}\n      {USE_DUAL_APPS && (\n        <div style={{ marginBottom: 16, padding: 12, background: '#e0f2fe', border: '1px solid #0891b2', borderRadius: 8, fontSize: 14 }}>\n          ðŸ”„ <strong>Dual App Mode Active:</strong> Using separate apps for login ({FACEBOOK_APPS.LOGIN}) and page management ({FACEBOOK_APPS.PAGES})\n        </div>\n      )}\n      {/* Show Connect button if not connected */}\n      {!facebookConnected && (\n        <div style={{ marginBottom: 24 }}>\n          <button onClick={loginWithFacebook} disabled={isConnecting} style={{ padding: '10px 24px', fontSize: 18 }}>\n            {isConnecting ? 'Connecting...' : 'Connect Facebook'}\n          </button>\n          <div style={{ marginTop: 10, color: '#666' }}>\n            Connect your Facebook account to manage posts, auto-replies, and more!\n          </div>\n        </div>\n      )}\n      {/* Show re-request permissions button if no pages found after connection */}\n      {facebookConnected && availablePages.length === 0 && !(USE_DUAL_APPS && (connectionStatus.includes('Now connect your pages app') || connectionStatus.includes('Pages app connection needed'))) && (\n        <div style={{ marginTop: 24, color: '#b91c1c', background: '#fff7f7', padding: 16, borderRadius: 8 }}>\n          <div style={{ marginBottom: 8 }}>\n            <strong>No Facebook Pages found.</strong> <br />\n            This may be because:\n            <ul style={{ margin: '8px 0 0 20px', color: '#b91c1c' }}>\n              <li>You did not select any pages during Facebook login.</li>\n              <li>You denied required permissions.</li>\n              <li>Your Facebook account does not have any managed pages.</li>\n              <li><strong>Your Facebook app configuration is incorrect.</strong></li>\n            </ul>\n          </div>\n          \n          <div style={{ margin: '12px 0', padding: 12, background: '#fef3c7', color: '#92400e', borderRadius: 4, fontSize: 14 }}>\n            <strong>ðŸ”§ Facebook App Setup Checklist:</strong>\n            <ol style={{ margin: '8px 0 0 20px' }}>\n              <li><strong>App Type:</strong> Should be \"Consumer\" or \"Business\" (not just page management)</li>\n              <li><strong>Use Cases:</strong> Add both \"Facebook Login\" AND \"Pages API\"</li>\n              <li><strong>App Review:</strong> Some permissions may need review for production</li>\n              <li><strong>Development Mode:</strong> Make sure you're added as an app tester</li>\n            </ol>\n            <div style={{ marginTop: 8 }}>\n              <strong>Login App ID:</strong> {FACEBOOK_APPS.LOGIN}<br/>\n              <strong>Pages App ID:</strong> {FACEBOOK_APPS.PAGES}<br/>\n              <strong>Using Dual Apps:</strong> {USE_DUAL_APPS ? 'Yes' : 'No'}<br/>\n              <strong>Current Mode:</strong> {USE_DUAL_APPS ? 'Dual App Setup' : 'Single App Setup'}\n            </div>\n          </div>\n          \n          <div style={{ display: 'flex', gap: 12, flexWrap: 'wrap' }}>\n            <button\n              onClick={loginWithFacebook}\n              style={{ padding: '8px 18px', background: '#1877f2', color: '#fff', border: 'none', borderRadius: 4, fontWeight: 600 }}\n            >\n              Re-request Facebook Permissions\n            </button>\n            {USE_DUAL_APPS && (\n              <button\n                onClick={loginWithPagesApp}\n                disabled={isConnecting}\n                style={{ padding: '8px 18px', background: '#059669', color: '#fff', border: 'none', borderRadius: 4, fontWeight: 600 }}\n              >\n                {isConnecting ? 'Connecting...' : 'Connect Pages App'}\n              </button>\n            )}\n            <button\n              onClick={() => {\n                window.open('https://developers.facebook.com/apps/', '_blank');\n              }}\n              style={{ padding: '8px 18px', background: '#6b7280', color: '#fff', border: 'none', borderRadius: 4, fontWeight: 600 }}\n            >\n              Open Facebook App Settings\n            </button>\n          </div>\n        </div>\n      )}\n      {/* Page selection UI if any pages exist */}\n      {facebookConnected && availablePages.length > 0 && (\n        <div className=\"page-select-section\" style={{ marginTop: 24 }}>\n          <label htmlFor=\"fb-page-select\"><strong>Select a Facebook Page:</strong></label>\n          <select\n            id=\"fb-page-select\"\n            value={selectedPage ? selectedPage.id : ''}\n            onChange={e => {\n              const page = availablePages.find(p => p.id === e.target.value);\n              if (page) {\n                setSelectedPage(page);\n                setConnectionStatus(`âœ… Page \"${page.name}\" selected successfully! You can now manage posts and auto-replies.`);\n                console.log('[Page Selection] Selected page:', page);\n              } else {\n                setSelectedPage(null);\n                setConnectionStatus('âš ï¸ Please select a page to continue.');\n              }\n            }}\n            style={{ marginLeft: 8, padding: '8px 12px', borderRadius: 4, border: '1px solid #ddd' }}\n          >\n            <option value=\"\">-- Select Page --</option>\n            {availablePages.map(page => (\n              <option key={page.id} value={page.id}>\n                {page.name} ({page.category}) {page.followerCount > 0 ? `- ${page.followerCount} followers` : ''}\n              </option>\n            ))}\n          </select>\n          {selectedPage && (\n            <div style={{ marginTop: 12, padding: 12, background: '#f0f9ff', borderRadius: 8, border: '1px solid #0ea5e9' }}>\n              <div style={{ display: 'flex', alignItems: 'center', marginBottom: 8 }}>\n                {selectedPage.profilePicture && (\n                  <img \n                    src={selectedPage.profilePicture} \n                    alt={selectedPage.name} \n                    width={40} \n                    height={40}\n                    style={{ borderRadius: '50%', marginRight: 12 }} \n                  />\n                )}\n                <div>\n                  <div style={{ fontWeight: 600, fontSize: 16 }}>{selectedPage.name}</div>\n                  <div style={{ color: '#666', fontSize: 14 }}>{selectedPage.category}</div>\n                </div>\n              </div>\n              <div style={{ fontSize: 14, color: '#0369a1' }}>\n                <div>âœ… Can post: {selectedPage.canPost ? 'Yes' : 'No'}</div>\n                <div>âœ… Can manage comments: {selectedPage.canComment ? 'Yes' : 'No'}</div>\n                {selectedPage.followerCount > 0 && (\n                  <div>ðŸ‘¥ Followers: {selectedPage.followerCount.toLocaleString()}</div>\n                )}\n              </div>\n            </div>\n          )}\n          {/* Show warning if pages exist but no selection */}\n          {!selectedPage && (\n            <div style={{ color: '#b91c1c', marginTop: 8, padding: 8, background: '#fef2f2', borderRadius: 4 }}>\n              âš ï¸ Please select a page from the dropdown above to enable posting and auto-reply features.\n            </div>\n          )}\n          {/* Debug: show availablePages raw data */}\n          <details style={{ marginTop: 12, fontSize: 13 }}>\n            <summary>Debug: Show available pages data ({availablePages.length} found)</summary>\n            <pre style={{ background: '#f3f3f3', padding: 8, borderRadius: 4, maxHeight: 200, overflow: 'auto' }}>{JSON.stringify(availablePages, null, 2)}</pre>\n          </details>\n        </div>\n      )}\n\n      {/* Show Pages App Login if basic login succeeded but pages auth needed */}\n      {USE_DUAL_APPS && facebookConnected && availablePages.length === 0 && (connectionStatus.includes('Now connect your pages app') || connectionStatus.includes('Pages app connection needed')) && (\n        <div style={{ marginTop: 24, padding: 16, background: '#f0fdf4', border: '1px solid #16a34a', borderRadius: 8 }}>\n          <div style={{ marginBottom: 12 }}>\n            <strong>âœ… Basic Facebook login successful!</strong><br/>\n            <span style={{ color: '#15803d' }}>Now connect your Pages app to manage Facebook pages:</span>\n          </div>\n          <button\n            onClick={loginWithPagesApp}\n            disabled={isConnecting}\n            style={{ \n              padding: '12px 24px', \n              background: '#16a34a', \n              color: '#fff', \n              border: 'none', \n              borderRadius: 6, \n              fontWeight: 600,\n              fontSize: 16\n            }}\n          >\n            {isConnecting ? 'Connecting to Pages App...' : 'ðŸ”— Connect Facebook Pages App'}\n          </button>\n        </div>\n      )}\n\n      {/* Main functionality - only show when a page is selected */}\n      {facebookConnected && selectedPage && (\n        <div style={{ marginTop: 32 }}>\n          {/* Auto-Reply Toggle */}\n          <div style={{ marginBottom: 24, padding: 16, background: '#f8fafc', borderRadius: 8, border: '1px solid #e2e8f0' }}>\n            <h3 style={{ margin: '0 0 12px 0', display: 'flex', alignItems: 'center', gap: 8 }}>\n              <AutoReplyIcon />\n              Auto-Reply to Comments\n            </h3>\n            <div style={{ display: 'flex', alignItems: 'center', gap: 12 }}>\n              <label style={{ display: 'flex', alignItems: 'center', gap: 8, cursor: 'pointer' }}>\n                <input\n                  type=\"checkbox\"\n                  checked={autoReplyEnabled}\n                  onChange={handleAutoReplyToggle}\n                  style={{ width: 18, height: 18 }}\n                />\n                {autoReplyEnabled ? 'Auto-reply is enabled' : 'Enable auto-reply to comments'}\n              </label>\n            </div>\n            <p style={{ margin: '8px 0 0 0', fontSize: 14, color: '#64748b' }}>\n              When enabled, the bot will automatically reply to new comments on your page posts.\n            </p>\n          </div>\n\n          {/* Tab Navigation */}\n          <div style={{ marginBottom: 24 }}>\n            <div style={{ display: 'flex', borderBottom: '2px solid #e2e8f0' }}>\n              <button\n                onClick={() => setActiveTab('auto')}\n                style={{\n                  padding: '12px 24px',\n                  border: 'none',\n                  background: activeTab === 'auto' ? '#3b82f6' : 'transparent',\n                  color: activeTab === 'auto' ? 'white' : '#64748b',\n                  borderRadius: '8px 8px 0 0',\n                  fontWeight: 600,\n                  cursor: 'pointer',\n                  display: 'flex',\n                  alignItems: 'center',\n                  gap: 8\n                }}\n              >\n                <AutoIcon />\n                AI Auto Post\n              </button>\n              <button\n                onClick={() => setActiveTab('manual')}\n                style={{\n                  padding: '12px 24px',\n                  border: 'none',\n                  background: activeTab === 'manual' ? '#3b82f6' : 'transparent',\n                  color: activeTab === 'manual' ? 'white' : '#64748b',\n                  borderRadius: '8px 8px 0 0',\n                  fontWeight: 600,\n                  cursor: 'pointer',\n                  display: 'flex',\n                  alignItems: 'center',\n                  gap: 8\n                }}\n              >\n                <ManualIcon />\n                Manual Post\n              </button>\n            </div>\n          </div>\n\n          {/* Content based on active tab */}\n          {activeTab === 'auto' && (\n            <div>\n              <h3 style={{ marginBottom: 16, display: 'flex', alignItems: 'center', gap: 8 }}>\n                <SparkleIcon />\n                AI-Generated Post\n              </h3>\n              <p style={{ color: '#64748b', marginBottom: 16 }}>\n                Describe what you want to post about, and AI will generate engaging content for you.\n              </p>\n              \n              <div style={{ marginBottom: 16 }}>\n                <label style={{ display: 'block', marginBottom: 8, fontWeight: 600 }}>\n                  Content Prompt:\n                </label>\n                <textarea\n                  name=\"prompt\"\n                  value={autoFormData.prompt}\n                  onChange={handleAutoInputChange}\n                  placeholder=\"e.g., 'Create a motivational post about entrepreneurship' or 'Write about our latest product launch'\"\n                  style={{\n                    width: '100%',\n                    minHeight: 100,\n                    padding: 12,\n                    border: '1px solid #d1d5db',\n                    borderRadius: 8,\n                    fontSize: 14,\n                    resize: 'vertical'\n                  }}\n                />\n              </div>\n\n              <button\n                onClick={generatePostContent}\n                disabled={autoFormData.isGenerating || !autoFormData.prompt.trim()}\n                style={{\n                  padding: '12px 24px',\n                  background: autoFormData.isGenerating ? '#94a3b8' : '#10b981',\n                  color: 'white',\n                  border: 'none',\n                  borderRadius: 8,\n                  fontWeight: 600,\n                  cursor: autoFormData.isGenerating ? 'not-allowed' : 'pointer',\n                  display: 'flex',\n                  alignItems: 'center',\n                  gap: 8,\n                  marginBottom: 16\n                }}\n              >\n                <SparkleIcon />\n                {autoFormData.isGenerating ? 'Generating...' : 'Generate Content'}\n              </button>\n\n              {autoFormData.generatedContent && (\n                <div style={{ marginBottom: 16 }}>\n                  <label style={{ display: 'block', marginBottom: 8, fontWeight: 600 }}>\n                    Generated Content:\n                  </label>\n                  <textarea\n                    value={autoFormData.generatedContent}\n                    onChange={(e) => setAutoFormData(prev => ({ ...prev, generatedContent: e.target.value }))}\n                    style={{\n                      width: '100%',\n                      minHeight: 120,\n                      padding: 12,\n                      border: '1px solid #d1d5db',\n                      borderRadius: 8,\n                      fontSize: 14,\n                      resize: 'vertical'\n                    }}\n                  />\n                  <p style={{ fontSize: 12, color: '#64748b', marginTop: 4 }}>\n                    You can edit the generated content before posting.\n                  </p>\n                </div>\n              )}\n            </div>\n          )}\n\n          {activeTab === 'manual' && (\n            <div>\n              <h3 style={{ marginBottom: 16, display: 'flex', alignItems: 'center', gap: 8 }}>\n                <ManualIcon />\n                Manual Post\n              </h3>\n              <p style={{ color: '#64748b', marginBottom: 16 }}>\n                Create and publish your own custom post content.\n              </p>\n              \n              <div style={{ marginBottom: 16 }}>\n                <label style={{ display: 'block', marginBottom: 8, fontWeight: 600 }}>\n                  Post Content:\n                </label>\n                <textarea\n                  name=\"message\"\n                  value={manualFormData.message}\n                  onChange={handleManualInputChange}\n                  placeholder=\"Write your post content here...\"\n                  style={{\n                    width: '100%',\n                    minHeight: 120,\n                    padding: 12,\n                    border: '1px solid #d1d5db',\n                    borderRadius: 8,\n                    fontSize: 14,\n                    resize: 'vertical'\n                  }}\n                />\n              </div>\n            </div>\n          )}\n\n          {/* Media Type Selection (for both tabs) */}\n          <div style={{ marginBottom: 16 }}>\n            <label style={{ display: 'block', marginBottom: 8, fontWeight: 600 }}>\n              Media Type:\n            </label>\n            <div style={{ display: 'flex', gap: 12 }}>\n              <button\n                onClick={() => handleMediaTypeChange('none', activeTab)}\n                style={{\n                  padding: '8px 16px',\n                  border: '1px solid #d1d5db',\n                  background: (activeTab === 'auto' ? autoFormData.mediaType : manualFormData.mediaType) === 'none' ? '#3b82f6' : 'white',\n                  color: (activeTab === 'auto' ? autoFormData.mediaType : manualFormData.mediaType) === 'none' ? 'white' : '#374151',\n                  borderRadius: 6,\n                  cursor: 'pointer',\n                  fontWeight: 500\n                }}\n              >\n                Text Only\n              </button>\n              <button\n                onClick={() => handleMediaTypeChange('photo', activeTab)}\n                style={{\n                  padding: '8px 16px',\n                  border: '1px solid #d1d5db',\n                  background: (activeTab === 'auto' ? autoFormData.mediaType : manualFormData.mediaType) === 'photo' ? '#3b82f6' : 'white',\n                  color: (activeTab === 'auto' ? autoFormData.mediaType : manualFormData.mediaType) === 'photo' ? 'white' : '#374151',\n                  borderRadius: 6,\n                  cursor: 'pointer',\n                  fontWeight: 500,\n                  display: 'flex',\n                  alignItems: 'center',\n                  gap: 4\n                }}\n              >\n                <ImageIcon />\n                Photo\n              </button>\n              <button\n                onClick={() => handleMediaTypeChange('video', activeTab)}\n                style={{\n                  padding: '8px 16px',\n                  border: '1px solid #d1d5db',\n                  background: (activeTab === 'auto' ? autoFormData.mediaType : manualFormData.mediaType) === 'video' ? '#3b82f6' : 'white',\n                  color: (activeTab === 'auto' ? autoFormData.mediaType : manualFormData.mediaType) === 'video' ? 'white' : '#374151',\n                  borderRadius: 6,\n                  cursor: 'pointer',\n                  fontWeight: 500,\n                  display: 'flex',\n                  alignItems: 'center',\n                  gap: 4\n                }}\n              >\n                <VideoIcon />\n                Video\n              </button>\n            </div>\n          </div>\n\n          {/* Media File Upload */}\n          {((activeTab === 'auto' && autoFormData.mediaType !== 'none') || \n            (activeTab === 'manual' && manualFormData.mediaType !== 'none')) && (\n            <div style={{ marginBottom: 16 }}>\n              <label style={{ display: 'block', marginBottom: 8, fontWeight: 600 }}>\n                Upload {activeTab === 'auto' ? autoFormData.mediaType : manualFormData.mediaType}:\n              </label>\n              <input\n                type=\"file\"\n                name=\"mediaFile\"\n                accept={activeTab === 'auto' \n                  ? (autoFormData.mediaType === 'photo' ? 'image/*' : 'video/*')\n                  : (manualFormData.mediaType === 'photo' ? 'image/*' : 'video/*')\n                }\n                onChange={activeTab === 'auto' ? handleAutoInputChange : handleManualInputChange}\n                style={{\n                  width: '100%',\n                  padding: 8,\n                  border: '1px solid #d1d5db',\n                  borderRadius: 6\n                }}\n              />\n            </div>\n          )}\n\n          {/* Post Button */}\n          <div style={{ marginTop: 24 }}>\n            <button\n              style={{\n                padding: '12px 32px',\n                background: isPublishing ? '#94a3b8' : '#1877f2',\n                color: 'white',\n                border: 'none',\n                borderRadius: 8,\n                fontWeight: 600,\n                cursor: isPublishing ? 'not-allowed' : 'pointer',\n                fontSize: 16,\n                display: 'flex',\n                alignItems: 'center',\n                gap: 8,\n                opacity: (isPublishing || !selectedPage || \n                         (activeTab === 'auto' && !autoFormData.generatedContent.trim()) ||\n                         (activeTab === 'manual' && !manualFormData.message.trim())) ? 0.6 : 1\n              }}\n              onClick={publishPost}\n              disabled={isPublishing || !selectedPage || \n                       (activeTab === 'auto' && !autoFormData.generatedContent.trim()) ||\n                       (activeTab === 'manual' && !manualFormData.message.trim())}\n            >\n              <RocketIcon />\n              {isPublishing ? 'Publishing...' : 'Publish Post'}\n            </button>\n            {/* Helper text */}\n            <p style={{ fontSize: 14, color: '#64748b', marginTop: 8 }}>\n              {!selectedPage ? 'Please select a page first' :\n               activeTab === 'auto' && !autoFormData.generatedContent.trim() ? 'Generate content first' :\n               activeTab === 'manual' && !manualFormData.message.trim() ? 'Enter your message first' :\n               'Ready to publish to your Facebook page'}\n            </p>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n\n\nexport default FacebookPage;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}